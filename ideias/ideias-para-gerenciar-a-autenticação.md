Sim, é perfeitamente viável e muitas vezes recomendado colocar a lógica de autenticação e autorização em uma camada de middlewares em uma aplicação Node.js com TypeScript. Vamos discutir como isso pode ser feito considerando as camadas que você mencionou:

1. **Camada de Middlewares**: Esta é uma escolha bastante comum e prática. Você pode criar middlewares específicos para lidar com a autenticação e autorização, e usá-los para proteger suas rotas conforme necessário. Por exemplo, você pode ter um middleware de autenticação que verifica se um usuário está autenticado e um middleware de autorização que verifica se o usuário tem as permissões adequadas para acessar um determinado recurso. Esses middlewares podem então ser aplicados a rotas individuais conforme necessário.

2. **Camada de Serviços**: Se a lógica de autenticação e autorização envolver operações mais complexas, como interagir com um banco de dados ou gerenciar sessões de usuário, pode ser apropriado colocar essa lógica em serviços dedicados. Nesse caso, você pode criar serviços de autenticação e autorização na camada de serviços e chamar esses serviços a partir dos middlewares aplicados às rotas relevantes.

3. **Camada "Common"**: Se a lógica de autenticação e autorização for genérica o suficiente para ser compartilhada entre diferentes partes da sua aplicação, colocá-la na camada "Common" também pode ser uma opção. Você pode criar utilitários ou funções comuns para lidar com a autenticação e autorização e importá-los sempre que necessário em outras partes do seu código, incluindo middlewares ou serviços.

Em resumo, a escolha da camada específica para colocar a lógica de autenticação e autorização depende da complexidade da sua aplicação, das suas preferências de arquitetura e do nível de reutilização que você espera da lógica de segurança. Qualquer uma das abordagens que você mencionou pode funcionar bem, desde que seja implementada de forma organizada e mantenham a clareza e a manutenibilidade do código.
